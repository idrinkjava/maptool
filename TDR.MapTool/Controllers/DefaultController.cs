using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace TDR.MapTool.Controllers
{
    public class DefaultController : Controller
    {
        // GET: Default

        public ActionResult Index()
        {
            return View();
        }

        public ActionResult MapTest()
        {
            return View();
        }

        public ActionResult Openlayer()
        {
            return View();
        }

        public ActionResult Openlayer1()
        {
            return View();
        }

        public ActionResult Openlayer2()
        {
            return View();
        }

        public ActionResult Openlayer3()
        {
            return View();
        }

        public JsonResult GetJson1()
        {
            return Json(@"{
displayFieldName: '网格编码',
fieldAliases: {
网格编码: '网格编码'
},
geometryType: 'esriGeometryPolygon',
spatialReference: {
wkt: 'PROJCS['CGCS_2000_GK_120_3N',GEOGCS['GCS_China_Geodetic_Coordinate_System_2000',DATUM['D_China_2000',SPHEROID['CGCS2000',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Gauss_Kruger'],PARAMETER['False_Easting',500000.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',120.0],PARAMETER['Scale_Factor',1.0],PARAMETER['Latitude_Of_Origin',0.0],UNIT['Meter',1.0]]'
},
fields: [
{
name: '网格编码',
type: 'esriFieldTypeString',
alias: '网格编码',
length: 50
}
],
features: [
{
attributes: {
网格编码: '330621011'
},
geometry: {
rings: [
[
[
547290.7918143225,
3327663.2205296136
],
[
547289.1141359304,
3327660.064977103
],
[
547286.0140661952,
3327661.7130523496
],
[
547272.7715434361,
3327637.685712039
],
[
547266.2380845661,
3327625.8311653663
],
[
547265.8698427121,
3327624.537545727
],
[
547267.3609563373,
3327585.6134884492
],
[
547271.157343264,
3327536.498479563
],
[
547270.9460883294,
3327535.048604273
],
[
547273.3601676379,
3327534.975228609
],
[
547273.3189626733,
3327533.665554981
],
[
547270.911902648,
3327533.7413721057
],
[
547264.3420060644,
3327505.9544856152
],
[
547260.3087882914,
3327487.9735103874
],
[
547260.0885577986,
3327485.694445668
],
[
547264.2047102659,
3327483.4061481226
],
[
547332.5738076696,
3327451.499890368
],
[
547330.4498817085,
3327446.9805258056
],
[
547258.164100881,
3327481.0939009725
],
[
547257.7874875721,
3327477.295012202
],
[
547261.3013905889,
3327476.0561283547
],
[
547260.2077153359,
3327472.8652331573
],
[
547256.9934427589,
3327473.8798654564
],
[
547248.462198358,
3327434.949253656
],
[
547244.2549911202,
3327407.973175619
],
[
547241.1374058018,
3327393.8555423548
],
[
547236.8859876744,
3327377.8498516693
],
[
547234.042480774,
3327369.533980071
],
[
547222.1027963626,
3327345.714893594
],
[
547212.509483221,
3327333.3680938813
],
[
547210.9513834732,
3327332.0592804477
],
[
547203.2591216565,
3327316.7259877007
],
[
547206.0291642874,
3327315.255959006
],
[
547204.3774878753,
3327312.1438648365
],
[
547201.607445243,
3327313.613893531
],
[
547201.2233966273,
3327312.8162617013
],
[
547274.8986848072,
3327277.917272387
],
[
547266.8433788733,
3327263.852637824
],
[
547241.8777788139,
3327277.633817368
],
[
547229.7296407816,
3327283.2966439403
],
[
547189.2503741577,
3327302.166181137
],
[
547130.0749785049,
3327329.750914387
],
[
547110.3791850837,
3327338.9320716583
],
[
547094.3879101926,
3327345.951951201
],
[
547020.0944294028,
3327378.565285267
],
[
546970.7198840149,
3327454.0473467535
],
[
546958.0769247132,
3327461.516813297
],
[
546855.4708038932,
3327522.1377525073
],
[
546766.3327404879,
3327574.801596417
],
[
546708.7677725335,
3327608.8115196023
],
[
546581.4887411072,
3327687.6043434595
],
[
546665.8472224814,
3327828.5507944515
],
[
546692.1678186996,
3327872.5275237313
],
[
546748.4386068262,
3327966.54458071
],
[
546800.950826999,
3328054.2820293442
],
[
546826.1198284698,
3328096.3344452153
],
[
546913.0602632801,
3328047.225778431
],
[
547012.4340575553,
3327991.093949403
],
[
547037.0829964546,
3327977.1710428246
],
[
547176.6019869108,
3327898.3631580304
],
[
547245.8764773906,
3327857.970354836
],
[
547274.7835948713,
3327839.8084644163
],
[
547283.486230452,
3327829.485099335
],
[
547289.0807532362,
3327824.5123220743
],
[
547383.6646416957,
3327780.1747163255
],
[
547381.1907923794,
3327776.329203029
],
[
547374.5753178538,
3327769.3542092936
],
[
547366.3250286747,
3327763.4148387243
],
[
547361.8296966123,
3327761.175403093
],
[
547356.4156957514,
3327759.2197935726
],
[
547348.0844278216,
3327757.96593889
],
[
547332.1942120604,
3327727.4356512
],
[
547335.0641103495,
3327725.673559447
],
[
547333.7702372378,
3327723.534273779
],
[
547306.8545999032,
3327682.2028350714
],
[
547304.5539209796,
3327680.509795655
],
[
547294.1457881363,
3327675.115067503
],
[
547292.6615431228,
3327673.7542501534
],
[
547287.7117038623,
3327664.9047387694
],
[
547290.7918143225,
3327663.2205296136
]
]
]
}
}
]
}", JsonRequestBehavior.AllowGet);
        }


        public ActionResult TDT()
        {
            return View();
        }

        public JsonResult GetRectData(double x1, double y1, double x2, double y2)
        {
            List<Marker> markers = new List<Marker>();
            Random random = new Random();
            for (int i = 0; i < 4; i++)
            {
                markers.Add(new Marker
                {
                    X = this.GetRandomNumber(random, x1, x2, 5),
                    Y = this.GetRandomNumber(random, y1, y2, 5),
                });
            }
            return Json(markers, JsonRequestBehavior.AllowGet);
        }
        public double GetRandomNumber(Random random, double minimum, double maximum, int Len)   //Len小数点保留位数
        {
            return Math.Round(random.NextDouble() * (maximum - minimum) + minimum, Len);
        }
    }
}

/// <summary>
/// 地图上标注对象
/// </summary>
public class Marker
{
    public string Id { get; set; }

    public string Name { get; set; }

    public string Icon { get; set; }

    public int Type { get; set; }

    public double X { get; set; }

    public double Y { get; set; }
}
